webpackJsonp([4],{"4c4K":function(e,t,a){(e.exports=a("UTlt")(!1)).push([e.i,"#user{width:100%;height:100%}#userTop{height:44px;text-align:left;line-height:44px;font-size:14px;font-family:黑体;font-weight:700;border-bottom:1px solid #dfdfdf}#user .help{width:20px;margin:0;padding:0;text-align:center}#user .help,.help:focus,.help:hover{border:none;-webkit-box-shadow:none;box-shadow:none;border-radius:0;color:#a7ada3;background-color:transparent}#user .help:hover{color:#5a5d56}#userTop .title{width:96%;margin:0 auto;height:44px}.aside_user_con{width:96%;margin:20px auto;font-size:14px;height:600px;position:relative;padding-top:50px}",""])},DRk5:function(e,t,a){var s=a("4c4K");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a("FIqI")("114a159b",s,!1,{sourceMap:!1})},DeLT:function(e,t,a){"use strict";var s=a("3cXf"),i=a.n(s),r=a("aozt"),o=a.n(r);t.a={name:"User",data:function(){var e=this;this.$createElement;return{data:[],userdata:[],value3:[1],value4:[1],tool:!1,onOff:!1,renderFunc:function(e,t){return e("span",[t.label," "])},useData:[],list:[],shua:!0,rote:!1,tableData:{userName:"",status:"",phone:"",email:"",comment:""},loading:!1,emailerror:null,telerror:null,pwderror:null,nameerror:null,addresserror:null,form:{city:"",erae:"",minerae:"",street:"",selectedOptions:[]},dialogTableVisible:!1,dialogFormVisible:!1,registration:!1,dialogUser:!1,addmsg:{namea:"",pwd:"",tel:"",email:"",comment:"",address:"",form:{city:"",erae:"",minerae:"",street:"",selectedOptions:[]}},addmsgs:{namea:[{required:!0,validator:function(e,t,a){""===t?a(new Error("账号不能为空")):/^[a-zA-Z0-9_-]{4,20}$/.test(t)?a():a(new Error("请输入正确的账号"))},trigger:"blur"}],pwd:[{required:!0,validator:function(t,a,s){""===a?s(new Error("* 密码不能为空")):/^[a-zA-Z0-9_-]{6,16}$/.test(a)?s():(e.pwderror="",s(new Error("* 密码由4到20个大小写字母、数字以及-_组成")))},trigger:"blur"}],tel:[{required:!0,validator:function(e,t,a){""===t?a(new Error("* 手机号不能为空")):/^1[3|4|5|7|8][0-9]{9}$/.test(t)?a():a(new Error("* 请输入正确的手机号"))},trigger:"blur"}],email:[{required:!0,validator:function(e,t,a){""===t?a(new Error("邮箱不能为空")):a()},trigger:"blur"}],comment:[{required:!0,validator:function(e,t,a){""===t?a(new Error("备注不能为空！")):a()},trigger:"blur"}],form:[{required:!0,validator:function(e,t,a){""==t.city?a(new Error("地址不能为空！")):a()},trigger:"change"}]},address:null,CityInfo:null}},methods:{escRea:function(){this.registration=!1,this.$message({message:"取消注册用户"})},resetForm:function(e){this.$refs[e].resetFields()},handleChangea:function(e){this.addmsg.form.city=this.myAddressCity(this.addmsg.form.selectedOptions[0]),this.addmsg.form.erae=this.myAddressErae(this.addmsg.form.selectedOptions[1]),this.addmsg.form.minerae=this.myAddressMinerae(this.addmsg.form.selectedOptions[2]),void 0==this.addmsg.form.city&&(this.addmsg.form.city=""),void 0==this.addmsg.form.erae&&(this.addmsg.form.erae=""),void 0==this.addmsg.form.minerae&&(this.addmsg.form.minerae=""),void 0==this.addmsg.form.street&&(this.addmsg.form.minerae=""),this.address=this.addmsg.form.city+this.addmsg.form.erae+this.addmsg.form.minerae+this.addmsg.form.street},open2:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$confirm("<div><ul><li>名字:"+t.addmsg.namea+"</li><li>密码:"+t.addmsg.pwd+"</li><li>手机号:"+t.addmsg.tel+"</li><li>邮箱:"+t.addmsg.email+"</li><li>地址:"+t.address+"</li><li>备注:"+t.addmsg.comment+"</li></ul></div>",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,beforeClose:function(e,a,s){var r=[{city:t.addmsg.form.city,erae:t.addmsg.form.erae,minerae:t.addmsg.form.minerae,street:t.addmsg.form.street,selectedOptions:t.addmsg.form.selectedOptions}];a.confirmButtonLoading=!0,a.confirmButtonText="执行中...",t.$axios.post("/user/register",{userName:t.addmsg.namea,password:t.addmsg.pwd,phone:t.addmsg.tel,email:t.addmsg.email,comment:t.addmsg.comment,address:i()(r)}).then(function(e){s(),a.confirmButtonLoading=!1,200==e.data.status?(t.$notify({title:"成功",message:"用户"+t.addmsg.namea+e.data.msg,type:"success"}),t.resetForm("addmsg"),t.form.selectedOptions=[]):400==e.data.status?t.$message({type:"error",message:e.data.msg}):t.$message({type:"warning",message:e.data.msg})})}}).then(function(){}).catch(function(){t.$message({type:"info",message:"取消提交"})})})},escUseN:function(){this.rote=!1,this.$message({message:"取消修改用户信息"})},escUsrRote:function(){this.dialogUser=!1,this.$message({message:"取消修改用户信息"})},escUse:function(){this.dialogFormVisible=!1,this.$message({message:"取消修改用户信息"})},dleSelectionChange:function(e){},sendUserChange:function(){var e=this,t=[];for(var a in this.value4)for(var s in this.userdata)this.userdata[s].key==Number(this.value4[a])&&t.push(this.userdata[s].id);this.$axios.post("/user/setUserAccess",{id:this.userid,accessIds:t.join(",")}).then(function(t){200==t.data.status&&(e.$notify({title:"成功",message:"用户"+t.data.msg,type:"success"}),e.dialogUser=!1)})},getUserRote:function(e){var t=this;this.$axios.post("/user/getUserAccess",{id:e}).then(function(a){for(var s in t.userdata=[],t.value4=[],a.data.data)1!=a.data.data[s].del&&t.userdata.push({key:s,id:a.data.data[s].id,disabled:1==a.data.data[s].del,label:a.data.data[s].accessName}),a.data.data[s].validAccess&&t.value4.push(s);t.userid=e,t.dialogUser=!0})},getRote:function(e){var t=this;this.$axios.post("/user/getUserRoles",{id:e}).then(function(a){for(var s in t.rote=!0,t.value3=[],t.rolesid=e,t.data=[],a.data.data)1!=a.data.data[s].del&&t.data.push({key:s,id:a.data.data[s].id,disabled:1==a.data.data[s].del,label:a.data.data[s].roleName}),a.data.data[s].validAccess&&t.value3.push(s)})},sendChange:function(e){var t=this,a=[];for(var s in this.value3)for(var i in this.data)this.data[i].key==Number(this.value3[s])&&a.push(this.data[i].id);this.$axios.post("/user/setUserRoles",{id:this.rolesid,roleIds:a.join(",")}).then(function(e){200==e.data.status?t.$notify({title:"成功",type:"success",message:e.data.msg}):400==e.data.status?t.$message({type:"error",message:e.data.msg}):t.$message({type:"warning",message:e.data.msg}),t.rote=!1})},pagechange:function(e){this.useData=[],this.loading=!0;for(var t=0;t<10;t++)void 0!=this.list[10*(e-1)+t]&&this.useData.push(this.list[10*(e-1)+t]);this.loading=!1},handleChange:function(e){this.form.city=this.myAddressCity(this.form.selectedOptions[0]),this.form.erae=this.myAddressErae(this.form.selectedOptions[1]),this.form.minerae=this.myAddressMinerae(this.form.selectedOptions[2]),void 0==this.form.city&&(this.form.city=""),void 0==this.form.erae&&(this.form.erae=""),void 0==this.form.minerae&&(this.form.minerae=""),void 0==this.form.street&&(this.form.minerae=""),this.address=this.form.city+this.form.erae+this.form.minerae+this.form.street},update:function(){var e=this,t=[{city:this.form.city,erae:this.form.erae,minerae:this.form.minerae,street:this.form.street,selectedOptions:this.form.selectedOptions}];this.$axios.post("/user/updateUser",{userName:this.tableData.userName,id:this.tableData.id,phone:this.tableData.tel,email:this.tableData.email,comment:this.tableData.comment,address:i()(t)}).then(function(t){console.log(e.tableData.userName),200==t.data.status?e.$notify({title:"成功",message:"用户"+e.tableData.userName+t.data.msg,type:"success"}):400==t.data.status?e.$message({type:"error",message:t.data.msg}):e.$message({type:"warning",message:t.data.msg}),e.dialogFormVisible=!1})},open4:function(e){var t=e;this.tableData={id:t.id,userName:t.userName,status:t.status,phone:t.phone,email:t.email,comment:t.comment},this.form=e.address[0],this.dialogFormVisible=!0},getall:function(){var e=this;this.$axios({url:"/user/getall"}).then(function(t){var a=e;e.list=t.data.data.data,e.shua=!0,e.list.forEach(function(e,t,s){a.list[t].address=JSON.parse(e.address)}),e.onOff=!1,e.pagechange(1)})},nametest:function(){return null!=this.namea?""==this.namea?(this.nameerror="* 账号不能为空",!1):(this.nameerror="",!0):(this.nameerror="",!1)},pwdest:function(){return null!=this.pwd?""==this.pwd?(this.pwderror="* 密码不能为空",!1):(this.pwderror="",!0):(this.pwderror="",!1)},addresstest:function(){return null!=this.address?""==this.address?(this.addresserror="* 地理位置不能为空",!1):(this.addresserror="",!0):(this.addresserror="",!1)},teltest:function(){return null!=this.tel?""==this.tel?(this.telerror="* 手机号不能为空",!1):/^1[3|4|5|7|8][0-9]{9}$/.test(this.tel)?(this.telerror="",!0):(this.telerror="* 请输入正确的手机号",!1):(this.telerror="",!1)},emailtest:function(){return null!=this.email?""==this.email?(this.emailerror="* 邮箱不能为空",!1):(this.emailerror="",!0):(this.emailerror="",!1)},deleteuser:function(e){var t=this,a=this;this.$confirm("此操作将删除该账号, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/user/delUser",{id:e.id}).then(function(e){200==e.data.status?t.$notify({title:"成功",message:"用户删除成功",type:"success"}):400==e.data.status?t.$message({type:"error",message:e.data.msg}):t.$message({type:"warning",message:e.data.msg}),a.getall()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getCityData:function(){var e=this;o.a.get("../city-data.json").then(function(t){e.CityInfo=t.data})},myAddressCity:function(e){if(this.CityInfo)for(var t in this.CityInfo)if(this.CityInfo[t].value==e)return this.CityInfo[t].label},myAddressErae:function(e){if(this.CityInfo)for(var t in this.CityInfo)for(var a in this.CityInfo[t].children)if(this.CityInfo[t].children[a].value==e&&void 0!=e)return this.CityInfo[t].children[a].label},myAddressMinerae:function(e){if(this.CityInfo)for(var t in this.CityInfo)for(var a in this.CityInfo[t].children)for(var s in this.CityInfo[t].children[a].children)if(this.CityInfo[t].children[a].children[s].value==e&&void 0!=e)return this.CityInfo[t].children[a].children[s].label},tableClass:function(e,t){return"headrClass"},shuaxin:function(){this.shua=!1,this.getall()}},mounted:function(){this.getall(),this.getCityData()},beforeMount:function(){this.onOff=!0},beforeCreate:function(){},beforeDestroy:function(){},beforeUpdate:function(){}}},lys7:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"user"}},[a("div",{attrs:{id:"userTop"}},[a("div",{staticClass:"title"},[e._v("\n      用户管理\n      "),a("el-button",{staticStyle:{float:"right","margin-top":"8px"},attrs:{size:"mini",title:"注册账号之类"},on:{click:function(t){e.registration=!0}}},[e._v("注册用户 "),a("i",{staticClass:"el-icon-plus"})]),a("el-tooltip",{attrs:{effect:"light",placement:"right","visible-arrow":e.tool}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("账号注册以及修改权限并且赋予角色")]),a("el-button",{staticClass:"help iconfont"},[e._v("")])],1)],1)]),a("div",{staticClass:"aside_user_con"},[a("div",{attrs:{id:"search"}},[a("div",{staticClass:"shuaxin"},[a("span",{staticClass:"shauxinspan",class:e.shua?"":"shuaxinBlue",on:{click:e.shuaxin}},[a("i",{staticClass:"iconfont shuaxinc",class:e.shua?"":"rotateI"},[e._v("")]),e._v(" 刷新 ")])]),e._m(0)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.onOff,expression:"onOff"}],attrs:{"element-loading-text":"拼命加载中",data:e.useData,stripe:"","header-row-class-name":e.tableClass,"highlight-current-row":"",height:"100%","default-sort":{prop:"date",order:"descending"}},on:{"selection-change":e.dleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"账号",sortable:"",prop:"userName"}}),a("el-table-column",{attrs:{label:"注册时间",sortable:"",prop:"registTime"}}),a("el-table-column",{attrs:{label:"账号状态",sortable:"",prop:"status"}}),a("el-table-column",{attrs:{label:"手机",sortable:"",prop:"phone"}}),a("el-table-column",{attrs:{label:"地址",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.address[0].city)+"/"+e._s(t.row.address[0].erae)+"/"+e._s(t.row.address[0].minerae))])]}}])}),a("el-table-column",{attrs:{label:"邮箱",sortable:"",prop:"email"}}),a("el-table-column",{attrs:{label:"简介",sortable:"",prop:"comment"}}),a("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{margin:"0"},attrs:{size:"mini"},on:{click:function(a){e.open4(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.getUserRote(t.row.id)}}},[e._v("角色")]),a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.getRote(t.row.id)}}},[e._v("权限")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteuser(t.row)}}},[e._v("删除")])]}}])})],1),a("div",[e.list.length>10?a("el-pagination",{staticStyle:{display:"inline-block"},attrs:{background:"",layout:"prev, pager, next","page-size":10,total:e.list.length},on:{"current-change":e.pagechange}}):e._e()],1),a("el-dialog",{attrs:{title:"修改用户角色信息",visible:e.rote,"append-to-body":!0,"before-close":e.escUseN},on:{"update:visible":function(t){e.rote=t}}},[a("div",{staticStyle:{"text-align":"center"}},[a("el-transfer",{staticStyle:{height:"300px","text-align":"left",display:"inline-block"},attrs:{filterable:"","left-default-checked":[0],"right-default-checked":[0],"render-content":e.renderFunc,titles:["添加角色","删除角色"],"button-texts":["删除","添加"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:e.data},on:{change:e.handleChange},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}})],1),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.escUseN}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendChange()}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"修改用户权限 ",visible:e.dialogUser,"append-to-body":!0,"before-close":e.escUsrRote},on:{"update:visible":function(t){e.dialogUser=t}}},[a("div",{staticClass:"auto",staticStyle:{"text-align":"center"}},[a("el-transfer",{staticStyle:{height:"300px","text-align":"left",display:"inline-block"},attrs:{filterable:"","render-content":e.renderFunc,titles:["添加权限","删除权限"],"button-texts":["删除","添加"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:e.userdata},on:{change:e.handleChange},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}})],1),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.escUsrRote}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sendUserChange()}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"修改用户信息",visible:e.dialogFormVisible,"append-to-body":!0,"before-close":e.escUse},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticClass:"auto",staticStyle:{height:"100%"}},[a("div",{staticClass:"userset"},[a("label",{staticClass:"label"},[e._v("账号:")]),e._v(" "+e._s(e.tableData.userName)+"\n        ")]),a("div",[a("label",{staticClass:"label"},[e._v(" 状态:")]),a("el-input",{staticStyle:{width:"240px"},model:{value:e.tableData.status,callback:function(t){e.$set(e.tableData,"status",t)},expression:"tableData.status"}})],1),a("div",{staticClass:"userset"},[a("label",{staticClass:"label"},[e._v("手机号:")]),a("el-input",{staticStyle:{width:"240px"},attrs:{oninput:e.teltest(),placeholder:"请输入手机号"},model:{value:e.tableData.phone,callback:function(t){e.$set(e.tableData,"phone",t)},expression:"tableData.phone"}}),a("div",{staticClass:"telerror error"},[e._v("\n            "+e._s(e.telerror)+"\n          ")])],1),a("div",{staticClass:"userset"},[a("label",{staticClass:"label"},[e._v("邮箱:")]),a("el-input",{staticStyle:{width:"240px"},attrs:{oninput:e.emailtest(),placeholder:"请输入邮箱"},model:{value:e.tableData.email,callback:function(t){e.$set(e.tableData,"email",t)},expression:"tableData.email"}}),a("div",{staticClass:"emailerror error"},[e._v("\n            "+e._s(e.emailerror)+"\n          ")])],1),a("div",{staticClass:"userset"},[a("label",{staticClass:"label"},[e._v("地址:")]),e.CityInfo?a("el-cascader",{staticStyle:{width:"240px"},attrs:{options:e.CityInfo,filterable:"","change-on-select":!0,clearable:!0},on:{change:e.handleChange},model:{value:e.form.selectedOptions,callback:function(t){e.$set(e.form,"selectedOptions",t)},expression:"form.selectedOptions"}}):e._e(),a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入详细位置或者忽略"},model:{value:e.form.street,callback:function(t){e.$set(e.form,"street",t)},expression:"form.street"}}),a("div",{staticClass:"addresserror error"},[e._v("\n            "+e._s(e.addresserror)+"\n          ")])],1),a("div",{staticClass:"userset"},[a("label",{staticClass:"label",staticStyle:{float:"left"}},[e._v("备注: ")]),a("el-input",{staticStyle:{width:"240px","margin-left":"3px"},attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:e.tableData.comment,callback:function(t){e.$set(e.tableData,"comment",t)},expression:"tableData.comment"}})],1),a("div",{staticStyle:{clear:"both",width:"100%",height:"1px"}})]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.escUse}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.update()}}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"注册用户",visible:e.registration,"append-to-body":!0,"before-close":e.escRea},on:{"update:visible":function(t){e.registration=t}}},[a("el-form",{ref:"addmsg",attrs:{model:e.addmsg,rules:e.addmsgs,"status-icon":""}},[a("el-form-item",{attrs:{label:"账号",prop:"namea"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入账号","auto-complete":"off"},model:{value:e.addmsg.namea,callback:function(t){e.$set(e.addmsg,"namea",t)},expression:"addmsg.namea"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"password",placeholder:"请输入密码","auto-complete":"off"},model:{value:e.addmsg.pwd,callback:function(t){e.$set(e.addmsg,"pwd",t)},expression:"addmsg.pwd"}})],1),a("el-form-item",{attrs:{label:"手机号",prop:"tel"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"tel",placeholder:"请输入手机号","auto-complete":"off"},model:{value:e.addmsg.tel,callback:function(t){e.$set(e.addmsg,"tel",t)},expression:"addmsg.tel"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"email",placeholder:"请输入邮箱","auto-complete":"off"},model:{value:e.addmsg.email,callback:function(t){e.$set(e.addmsg,"email",t)},expression:"addmsg.email"}})],1),a("el-form-item",{attrs:{label:"地址",required:!0,prop:"form"}},[e.CityInfo?a("el-cascader",{staticStyle:{width:"240px"},attrs:{options:e.CityInfo,filterable:"","change-on-select":!0,clearable:!0},on:{change:e.handleChangea},model:{value:e.addmsg.form.selectedOptions,callback:function(t){e.$set(e.addmsg.form,"selectedOptions",t)},expression:"addmsg.form.selectedOptions"}}):e._e()],1),a("el-form-item",{attrs:{label:"详细地址"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入详细位置或者忽略"},model:{value:e.addmsg.form.street,callback:function(t){e.$set(e.addmsg.form,"street",t)},expression:"addmsg.form.street"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"comment"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"textarea",placeholder:"请输入内容",cols:5},model:{value:e.addmsg.comment,callback:function(t){e.$set(e.addmsg,"comment",t)},expression:"addmsg.comment"}})],1),a("el-form-item",{staticStyle:{"margin-left":"10%"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.open2("addmsg")}}},[e._v("提交")]),a("el-button",{on:{click:function(t){e.resetForm("addmsg")}}},[e._v("重置")])],1)],1)],1)],1)])};s._withStripped=!0;var i={render:s,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search_con"},[t("i",{staticClass:"iconfont"},[this._v("")]),t("input",{attrs:{type:"search",placeholder:"请输入搜索内容"}})])}]};t.a=i},tn3Q:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("DeLT"),i=a("lys7"),r=!1;var o=function(e){r||a("DRk5")},l=a("X4nt")(s.a,i.a,!1,o,null,null);l.options.__file="pages\\System\\user\\index.vue",t.default=l.exports}});