webpackJsonp([8],{"+NG4":function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"role"}},[o("div",{staticClass:"role_nav"},[o("div",{staticClass:"title"},[e._v("\n        角色管理\n        "),o("el-button",{staticStyle:{float:"right","margin-top":"8px"},attrs:{size:"mini",title:"添加角色"},on:{click:function(t){e.registration=!0}}},[e._v("注册角色 "),o("i",{staticClass:"el-icon-plus"})]),o("el-tooltip",{attrs:{effect:"light",placement:"right","visible-arrow":e.tool}},[o("div",{attrs:{slot:"content"},slot:"content"},[e._v("角色注册以及修改权限")]),o("el-button",{staticClass:"help iconfont"},[e._v("")])],1)],1)]),o("div",{staticClass:"role_con"},[o("div",{attrs:{id:"search"}},[o("div",{staticClass:"shuaxin"},[o("span",{staticClass:"shauxinspan",class:e.shua?"":"shuaxinBlue",on:{click:e.shuaxin}},[o("i",{staticClass:"iconfont shuaxinc",class:e.shua?"":"rotateI"},[e._v("")]),e._v(" 刷新 ")])]),e._m(0)]),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.onOff,expression:"onOff"}],attrs:{height:"100%",data:e.roleTable,"row-class-name":e.roleRow,"element-loading-text":"拼命加载中"}},[o("el-table-column",{attrs:{prop:"roleName",label:"角色",sortable:"",width:"180"}}),o("el-table-column",{attrs:{prop:"insertTime",label:"增加时间",sortable:"",width:"180"}}),o("el-table-column",{attrs:{prop:"updateTime",label:"跟新时间",sortable:"",width:"180"}}),o("el-table-column",{attrs:{prop:"comment",label:"角色备注",sortable:"",width:"180"}}),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticStyle:{margin:"0"},attrs:{size:"mini",disabled:1==t.row.del},on:{click:function(o){e.handleEdit(t.row)}}},[e._v("编辑")]),o("el-button",{attrs:{size:"mini",disabled:1==t.row.del},on:{click:function(o){e.getUserRote(t.row.id)}}},[e._v("权限")]),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),o("el-dialog",{attrs:{title:"修改角色信息",visible:e.roleDialog,"append-to-body":!0,"before-close":e.escUseN},on:{"update:visible":function(t){e.roleDialog=t}}},[o("el-form",{ref:"roleForm",attrs:{model:e.roleForm,"status-icon":"",rules:e.roleRule,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"角色名称",prop:"rolesname"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.roleForm.rolesname,callback:function(t){e.$set(e.roleForm,"rolesname",t)},expression:"roleForm.rolesname"}})],1),o("el-form-item",{attrs:{label:"角色备注",prop:"comment"}},[o("el-input",{attrs:{"auto-complete":"off"},model:{value:e.roleForm.comment,callback:function(t){e.$set(e.roleForm,"comment",t)},expression:"roleForm.comment"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("roleForm")}}},[e._v("提交")]),o("el-button",{on:{click:function(t){e.resetForm("roleForm")}}},[e._v("重置")])],1)],1)],1),o("el-dialog",{attrs:{title:"修改角色权限",visible:e.setUseRote,"append-to-body":!0,"before-close":e.escUseRote},on:{"update:visible":function(t){e.setUseRote=t}}},[o("el-transfer",{staticStyle:{height:"300px","text-align":"left",display:"inline-block"},attrs:{filterable:"","left-default-checked":e.leftchecked,"right-default-checked":e.rightchecked,"render-content":e.renderFunc,titles:["添加角色","删除角色"],"button-texts":["删除","添加"],format:{noChecked:"${total}",hasChecked:"${checked}/${total}"},data:e.data},on:{change:e.handleChange},model:{value:e.role_,callback:function(t){e.role_=t},expression:"role_"}}),o("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.sendUserChange}},[e._v("提交")]),o("el-button",{on:{click:function(t){e.setUseRote=!1}}},[e._v("取消")])],1)],1)],1),o("el-dialog",{attrs:{title:"注册用户",visible:e.registration,"append-to-body":!0,"before-close":e.escRea},on:{"update:visible":function(t){e.registration=t}}},[o("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm2,"status-icon":"",rules:e.rules2}},[o("el-form-item",{attrs:{label:"角色名称",prop:"rolesname",required:!0}},[o("el-input",{staticStyle:{width:"240px"},attrs:{"auto-complete":"off"},model:{value:e.ruleForm2.rolesname,callback:function(t){e.$set(e.ruleForm2,"rolesname",t)},expression:"ruleForm2.rolesname"}})],1),o("el-form-item",{attrs:{label:"角色备注",prop:"comment",required:!0}},[o("el-input",{staticStyle:{width:"240px"},attrs:{"auto-complete":"off"},model:{value:e.ruleForm2.comment,callback:function(t){e.$set(e.ruleForm2,"comment",t)},expression:"ruleForm2.comment"}})],1),o("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:""}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForma("ruleForm2")}}},[e._v("提交")]),o("el-button",{on:{click:function(t){e.resetForma("ruleForm2")}}},[e._v("重置")])],1)],1)],1)],1)};a._withStripped=!0;var s={render:a,staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search_con"},[t("i",{staticClass:"iconfont"},[this._v("")]),t("input",{attrs:{type:"search",placeholder:"请输入搜索内容"}})])}]};t.a=s},NDvT:function(e,t,o){(e.exports=o("UTlt")(!1)).push([e.i,"#role[data-v-2b5e103a]{width:100%;height:100%;position:relative}.role_nav[data-v-2b5e103a]{height:44px;text-align:left;line-height:44px;font-size:14px;font-family:黑体;font-weight:700;border-bottom:1px solid #dfdfdf}.role_con[data-v-2b5e103a]{width:96%;margin:20px auto;font-size:14px;height:600px;position:relative;padding-top:50px}.role_nav .title[data-v-2b5e103a]{width:96%;margin:0 auto;height:44px}",""])},dyUc:function(e,t,o){"use strict";t.a={name:"role",data:function(){this.$createElement;var e=function(e,t,o){""===t?o(new Error("请输入角色名")):o()},t=function(e,t,o){""===t?o(new Error("请输入角色注释")):o()};return{loading:!1,data:function(e){for(var t=[],o=1;o<=15;o++)t.push({key:o,label:"备选项 "+o,disabled:o%4==0});return t}(),shua:!0,leftchecked:[],rightchecked:[],roleTable:[],role_:[1],onOff:!1,registration:!1,renderFunc:function(e,t){return e("span",[" ",t.label," "])},setUseRote:!1,roleDialog:!1,tool:!1,roleForm:{id:"",rolesname:"",comment:""},roleRule:{rolesname:[{validator:e,trigger:"blur"}],comment:[{validator:t,trigger:"blur"}]},ruleForm2:{rolesname:"",comment:""},rules2:{rolesname:[{validator:e,trigger:"blur"}],comment:[{validator:t,trigger:"blur"}]}}},methods:{escRea:function(){this.registration=!1,this.$message({message:"取消注册角色"})},escUseN:function(){this.roleDialog=!1,this.$message({type:"info",message:"取消角色修改"})},escUseRote:function(){this.setUseRote=!1,this.$message({type:"info",message:"取消角色修改权限"})},handleChange:function(e){},sendUserChange:function(){var e=this,t=[];for(var o in this.role_)for(var a in this.data)this.data[a].key==Number(this.role_[o])&&t.push(this.data[a].id);this.$axios.post("/roles/setRolesAccess",{id:this.userid,ids:t.join(",")}).then(function(t){200==t.data.status?e.$notify({title:"成功",type:"success",message:t.data.msg}):400==t.data.status?e.$message({type:"error",message:t.data.msg}):e.$message({type:"warning",message:t.data.msg}),e.setUseRote=!1})},getUserRote:function(e){var t=this;this.$axios.post("/roles/getRolesAccess",{id:e}).then(function(o){for(var a in t.role_=[],t.data=[],t.rightchecked=[],t.leftchecked=[],t.shua=!0,o.data.data)t.data.push({key:a,id:o.data.data[a].id,disabled:1==o.data.data[a].del,label:o.data.data[a].accessName}),o.data.data[a].validAccess&&t.role_.push(a);t.userid=e,t.setUseRote=!0})},getallRos:function(){var e=this;this.$axios.post("/roles/getall").then(function(t){200==t.data.status&&(e.shua=!0,e.roleTable=t.data.data,e.onOff=!1)})},roleRow:function(e){var t=e.row;e.rowIndex;return 1===t.del?"warning-row":""},handleEdit:function(e){var t=e;this.roleDialog=!0,this.roleForm.id=t.id,this.roleForm.rolesname=t.roleName,this.roleForm.comment=t.comment},handleDelete:function(e){var t=this;this.$confirm("此权限将被删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/roles/delRole",{id:e}).then(function(e){200==e.data.status?(t.$message({type:"success",message:"删除成功!"}),t.getallRos()):t.$message({type:"error",message:e.data.msg})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},submitForm:function(e){var t=this,o=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.$axios.post("/roles/upRole",{id:o.roleForm.id,roleName:o.roleForm.rolesname,comment:o.roleForm.comment}).then(function(e){t.roleDialog=!1,t.getallRos(),200==e.data.status?t.$message({type:"success",message:e.data.msg}):t.$message({type:"warning",message:e.data.msg}),t.roleDialog=!1})})},resetForm:function(e){this.$refs[e].resetFields()},submitForma:function(e){var t=this,o=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.$axios.post("/roles/addRole",{roleName:o.ruleForm2.rolesname,comment:o.ruleForm2.comment}).then(function(e){200==e.data.status?t.$notify({title:"成功",message:"角色"+t.ruleForm2.rolesname+e.data.msg,type:"success"}):400==e.data.status?t.$message({type:"error",message:e.data.msg}):t.$message({type:"warning",message:e.data.msg}),t.registration=!1})})},resetForma:function(e){this.$refs[e].resetFields()},shuaxin:function(){this.shua=!1,this.getallRos()}},mounted:function(){this.getallRos()},beforeMount:function(){this.onOff=!0},beforeCreate:function(){},beforeDestroy:function(){},beforeUpdate:function(){}}},itOk:function(e,t,o){var a=o("NDvT");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o("FIqI")("3d6ecfc6",a,!1,{sourceMap:!1})},tIpt:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("dyUc"),s=o("+NG4"),r=!1;var l=function(e){r||o("itOk")},i=o("X4nt")(a.a,s.a,!1,l,"data-v-2b5e103a",null);i.options.__file="pages\\System\\role\\index.vue",t.default=i.exports}});