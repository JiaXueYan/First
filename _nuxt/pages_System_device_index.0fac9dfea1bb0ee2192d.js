webpackJsonp([10],{Dcwy:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"device"}},[a("div",{staticClass:"device_nav"},[a("div",{staticClass:"title"},[e._v("\n      设备管理\n      "),a("el-button",{staticStyle:{float:"right","margin-top":"8px"},attrs:{size:"mini",title:"添加设备"},on:{click:function(t){e.registration=!0}}},[e._v("注册设备 "),a("i",{staticClass:"el-icon-plus"})]),a("el-button",{staticStyle:{float:"right","margin-top":"8px"},attrs:{size:"mini",title:"批量添加设备"},on:{click:function(t){e.registrationmore=!0}}},[e._v("批量注册设备 "),a("i",{staticClass:"el-icon-plus"})]),a("el-tooltip",{attrs:{effect:"light",placement:"right","visible-arrow":e.tool}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("设备注册以及设置归属公司")]),a("el-button",{staticClass:"help iconfont"},[e._v("")])],1)],1)]),a("div",{staticClass:"device_con"},[a("div",{attrs:{id:"search"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.search.devaceType,callback:function(t){e.$set(e.search,"devaceType",t)},expression:"search.devaceType"}},e._l(e.deviceTypeList,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.typeName}})})),a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入设备Inei",id:"deviceImei",clearable:""},model:{value:e.search.imei,callback:function(t){e.$set(e.search,"imei",t)},expression:"search.imei"}}),a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择企业"},model:{value:e.search.companyId,callback:function(t){e.$set(e.search,"companyId",t)},expression:"search.companyId"}},e._l(e.companytable,function(t){return a("el-option",{key:t.value,attrs:{label:t.companyName,value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.companyName))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v("ID："+e._s(t.id))])])})),a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.search.pdofnm,callback:function(t){e.$set(e.search,"pdofnm",t)},expression:"search.pdofnm"}},[a("el-option",{attrs:{value:"0",label:"电信平台"}}),a("el-option",{attrs:{value:"1",label:"华为平台"}}),a("el-option",{attrs:{value:"2",label:"移动平台"}})],1),a("el-button",{staticStyle:{float:"right","margin-right":"10px"},on:{click:e.setAllselect}},[e._v("重置")]),a("el-button",{staticStyle:{float:"right","margin-right":"10px"},on:{click:function(t){e.getAllDevice(!1)}}},[e._v("查询")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.onOff,expression:"onOff"}],staticStyle:{"text-align":"left"},attrs:{height:"502",width:"100%",data:e.deviceList,"label-position":"center","element-loading-text":"拼命加载中"}},[a("el-table-column",{attrs:{label:"设备类型",prop:"deviceType"}}),a("el-table-column",{attrs:{label:"设备imei",prop:"imei",sortable:""}}),a("el-table-column",{attrs:{label:"设备状态",prop:"binddevice"}}),a("el-table-column",{attrs:{label:"通信方式",prop:"wireless"}}),a("el-table-column",{attrs:{label:"设备波段",prop:"waveband"}}),a("el-table-column",{attrs:{label:"平台信息",prop:"platformTag"}}),a("el-table-column",{attrs:{label:"企业ID",prop:"companyId"}}),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{margin:"0"},attrs:{size:"mini"}},[e._v(" 编辑")]),a("el-button",{staticStyle:{margin:"0"},attrs:{size:"mini"},on:{click:function(a){e.subDevice(t.row)}}},[e._v(" 详情")]),a("el-button",{staticStyle:{margin:"0"},attrs:{size:"mini",type:"danger"},on:{click:function(a){e.deleteDevice(t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":10,layout:"total,prev, pager, next, jumper",total:e.pageMax},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"注册设备",visible:e.registration,"append-to-body":!0,"before-close":e.escRea},on:{"update:visible":function(t){e.registration=t}}},[a("el-form",{ref:"device",attrs:{model:e.device,"label-position":e.position_type,rules:e.deviceRules}},[a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"设备类型",prop:"deviceTypeId"}},[a("el-radio-group",{model:{value:e.device.deviceTypeId,callback:function(t){e.$set(e.device,"deviceTypeId",t)},expression:"device.deviceTypeId"}},e._l(e.deviceTypeList,function(t,i){return a("el-radio",{key:i,attrs:{label:t.id}},[e._v(e._s(t.typeName))])}))],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"设备通信",prop:"wireless"}},[a("el-radio-group",{model:{value:e.device.wireless,callback:function(t){e.$set(e.device,"wireless",t)},expression:"device.wireless"}},[a("el-radio",{attrs:{label:"0"}},[e._v("NB-IoT")]),a("el-radio",{attrs:{label:"1"}},[e._v("LoRaWAN")]),a("el-radio",{attrs:{label:"2"}},[e._v("GPRS")]),a("el-radio",{attrs:{label:"3"}},[e._v("WCDMA")])],1)],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"设备imei",prop:"imei"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"text",placeholder:"请输入设备Imei"},model:{value:e.device.imei,callback:function(t){e.$set(e.device,"imei",t)},expression:"device.imei"}})],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"设备波段",prop:"waveband"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"text",placeholder:"请输入设备波段"},model:{value:e.device.waveband,callback:function(t){e.$set(e.device,"waveband",t)},expression:"device.waveband"}}),e._v("\n          (单位：M Hz)\n        ")],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"平台信息",prop:"platformTag"}},[a("el-radio-group",{model:{value:e.device.platformTag,callback:function(t){e.$set(e.device,"platformTag",t)},expression:"device.platformTag"}},[a("el-radio",{attrs:{label:"0"}},[e._v("电信平台")]),a("el-radio",{attrs:{label:"1"}},[e._v("华为平台")]),a("el-radio",{attrs:{label:"2"}},[e._v("移动平台")])],1)],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"选择企业",prop:"companyId"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择企业"},model:{value:e.device.companyId,callback:function(t){e.$set(e.device,"companyId",t)},expression:"device.companyId"}},e._l(e.companytable,function(t){return a("el-option",{key:t.value,attrs:{label:t.companyName,value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.companyName))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v("ID："+e._s(t.id))])])}))],1),a("el-form-item",{staticStyle:{"text-align":"left"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("device")}}},[e._v("提交")]),a("el-button",{on:{click:function(t){e.resetForm("device")}}},[e._v("重置")])],1)],1)],1),a("el-dialog",{attrs:{title:"批量注册设备",visible:e.registrationmore,"append-to-body":!0,"before-close":e.escRea},on:{"update:visible":function(t){e.registrationmore=t}}},[a("el-form",{ref:"device",attrs:{model:e.moreDevice,"label-position":e.position_type,rules:e.deviceRules}},[a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"设备类型",prop:"deviceTypeId"}},[a("el-radio-group",{model:{value:e.moreDevice.deviceTypeId,callback:function(t){e.$set(e.moreDevice,"deviceTypeId",t)},expression:"moreDevice.deviceTypeId"}},e._l(e.deviceTypeList,function(t,i){return a("el-radio",{key:i,attrs:{label:t.id}},[e._v(e._s(t.typeName))])}))],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"设备通信",prop:"wireless"}},[a("el-radio-group",{model:{value:e.moreDevice.wireless,callback:function(t){e.$set(e.moreDevice,"wireless",t)},expression:"moreDevice.wireless"}},[a("el-radio",{attrs:{label:"0"}},[e._v("NB-IoT")]),a("el-radio",{attrs:{label:"1"}},[e._v("LoRaWAN")]),a("el-radio",{attrs:{label:"2"}},[e._v("GPRS")]),a("el-radio",{attrs:{label:"3"}},[e._v("WCDMA")])],1)],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"设备波段",prop:"waveband"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"text",placeholder:"请输入设备波段"},model:{value:e.moreDevice.waveband,callback:function(t){e.$set(e.moreDevice,"waveband",t)},expression:"moreDevice.waveband"}}),e._v("\n              (单位：M Hz)\n            ")],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"平台信息",prop:"platformTag"}},[a("el-radio-group",{model:{value:e.moreDevice.platformTag,callback:function(t){e.$set(e.moreDevice,"platformTag",t)},expression:"moreDevice.platformTag"}},[a("el-radio",{attrs:{label:"0"}},[e._v("电信平台")]),a("el-radio",{attrs:{label:"1"}},[e._v("华为平台")]),a("el-radio",{attrs:{label:"2"}},[e._v("移动平台")])],1)],1),a("el-form-item",{staticStyle:{"text-align":"left"},attrs:{label:"选择企业",prop:"companyId"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择企业"},model:{value:e.moreDevice.companyId,callback:function(t){e.$set(e.moreDevice,"companyId",t)},expression:"moreDevice.companyId"}},e._l(e.companytable,function(t){return a("el-option",{key:t.value,attrs:{label:t.companyName,value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.companyName))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v("ID："+e._s(t.id))])])}))],1)],1),a("el-upload",{ref:"upload",attrs:{"auto-upload":e.active,data:e.moreDevice,action:"http://192.168.1.15:8081/device/addDevices","on-success":e.success,"on-error":e.errorback,"on-change":e.onchangelist,multiple:""}},[a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("请上传对应格式的.xlsx文件")]),a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:function(t){e.next("device")}}},[e._v("提交")])],1),a("div",{attrs:{slot:"footer"},slot:"footer"})],1)],1)])};i._withStripped=!0;var l={render:i,staticRenderFns:[]};t.a=l},Oe0q:function(e,t,a){"use strict";t.a={name:"device",data:function(){var e=function(e,t,a){""===t?a(new Error("此处不能为空")):a()};return{pageMax:0,deviceList:[],remenber:{},deviceType:[{value:"0",label:"智能井盖"},{value:"1",label:"智能停车位"},{value:"2",label:"智能垃圾箱"},{value:"3",label:"智能停车位"}],registration:!1,registrationmore:!1,onOff:!0,shua:!0,active:!1,tool:!1,moreFile:!1,search:{imei:"",pdofnm:"",devaceType:"",status:"",companyId:""},statusDvice:[{value:"0",label:"NB-IoT"},{value:"1",label:"LoRaWAN"},{value:"2",label:"GPRS"},{value:"3",label:"WCDMA"}],device:{deviceTypeId:"",imei:"",wireless:"",waveband:"",platformTag:"",companyId:""},moreDevice:{deviceTypeId:null,wireless:null,waveband:null,platformTag:null,companyId:null},deviceTypeList:[],filelist:[],companytable:null,deviceRules:{deviceTypeId:[{required:!0,validator:e,trigger:"change"}],imei:[{required:!0,validator:function(e,t,a){""===t?a(new Error("此处不能为空")):/^[1-9]\d{14}$/.test(t)?a():a(new Error("设备Imei必须为非0开头的15位数字"))},trigger:"blur"}],wireless:[{required:!0,validator:function(e,t,a){""===t?a(new Error("此处不能为空")):a()},trigger:"change"}],waveband:[{required:!0,validator:function(e,t,a){""===t?a(new Error("此处不能为空")):/^\d{0,6}$/.test(t)?a():a(new Error("设备波段长度最多为6位"))},trigger:"blur"}],platformTag:[{required:!0,validator:e,trigger:"change"}],companyId:[{required:!0,validator:function(e,t,a){""===t?a(new Error("此处不能为空")):/^\d{0,11}$/.test(t)?a():a(new Error("企业ID长度最多为11位数字"))},trigger:"change"}]},currentPage:1,position_type:"left"}},methods:{next:function(e){var t=this;this.$refs[e].validate(function(a){a&&(console.log(t.moreDevice),t.moreFile?(t.$refs.upload.submit(),t.resetForm(e)):t.$message({type:"error",message:"请上传一个.xlsx文件"}))})},onchangelist:function(e,t){if(".xlsx"!="."+e.name.replace(/.+\./,""))return this.$message({type:"error",message:"请正确上传.xlsx文件"}),!1;this.moreFile=!0},getAlldeviceType:function(){var e=this;this.$axios({url:"/deviceType/getAll",method:"post"}).then(function(t){e.deviceTypeList=t.data.data})},success:function(e,t,a){var i=this;200==e.status?(null!=e.data.success&&setTimeout(function(){i.$notify({title:e.data.success.msg,message:'<div style="max-height: 300px;overflow: auto;width: 260px">'+e.data.success.imeis.join(",<br>")+"  </div>",type:"success",dangerouslyUseHTMLString:!0,duration:0})},20),null!=e.data.error&&setTimeout(function(){i.$notify({title:e.data.error.msg,message:'<div style="max-height: 300px;overflow: auto;width: 260px">'+e.data.error.imeis.join(",<br>")+"  </div>",type:"error",dangerouslyUseHTMLString:!0,duration:0},50)}),null!=e.data.exist&&setTimeout(function(){i.$notify({title:e.data.exist.msg,message:'<div style="max-height: 300px;overflow: auto;width: 260px">'+e.data.exist.imeis.join(",<br>")+"</div>",type:"warning",dangerouslyUseHTMLString:!0,duration:0})},100),null!=e.data.failure&&setTimeout(function(){i.$notify({title:e.data.failure.msg,message:'<div style="max-height: 300px;overflow: auto;width: 260px">'+e.data.failure.imeis.join(",<br>")+"  </div>",type:"info",dangerouslyUseHTMLString:!0,duration:0})},60),this.registrationmore=!1,this.moreDevice={deviceTypeId:null,wireless:null,waveband:null,platformTag:null,companyId:null},this.moreFile=!1):400==e.status?(this.$message({type:"error",message:e.data}),this.moreFile=!0):(this.$message({type:"warning",message:e.data}),this.moreFile=!0),this.getAllDevice()},errorback:function(e,t,a){console.log(e,t)},beforeUpload:function(e){},submitForm:function(e){var t=this;this.$refs[e].validate(function(a){a&&t.$axios.post("/device/addDevice",{imei:t.device.imei,deviceTypeId:t.device.deviceTypeId,wireless:t.device.wireless,waveband:t.device.waveband,platformTag:t.device.platformTag,companyId:t.device.companyId}).then(function(a){200==a.data.status?t.$notify({title:"成功",message:"设备"+t.device.imei+a.data.msg,type:"success"}):400==a.data.status?t.$message({type:"error",message:a.data.msg}):t.$message({type:"warning",message:a.data.msg}),t.registration=!1,t.getAllDevice(),t.resetForm(e)})})},resetForm:function(e){this.$refs[e].resetFields()},subDevice:function(e){this.$store.commit("SET_DEVICE",e),"DF702"==e.model?this.$router.push("/System/subDevice"):"DO100"==e.model&&this.$router.push("/System/subDeviceDO100")},escRea:function(){this.registration=!1,this.registrationmore=!1,this.$message({message:"取消注册设备"})},escUseRote:function(){this.businessOnOff=!1,this.$message({type:"info",message:"取消修改"})},sendChange:function(){var e=this;this.$axios.post("/company/updCompany",{id:this.setCom.id,companyName:this.setCom.companyName,comment:this.setCom.comment,tel:this.setCom.tel,address:this.setCom.address,postCode:this.setCom.postCode}).then(function(t){200==t.data.status&&(e.$notify({title:"成功",type:"success",message:t.data.msg}),e.getAllCompany(),e.businessOnOff=!1)})},getAllDevice:function(e,t){var a=this;this.onOff=!0,1==e?this.$axios({url:"device/getDeviceInfoByCondition",method:"post",data:{imei:this.remenber.imei,deviceTypeId:this.remenber.deviceTypeId,platform:this.remenber.platform,companyId:this.remenber.companyId,pageNo:t,pageSize:10}}).then(function(e){200==e.data.status&&(console.log(e),a.pageMax=e.data.data.totalCount,a.deviceList=e.data.data.list,a.onOff=!1)}):this.$axios({url:"device/getDeviceInfoByCondition",method:"post",data:{imei:this.search.imei,deviceTypeId:this.search.devaceType,platform:this.search.pdofnm,companyId:this.search.companyId,pageNo:1,pageSize:10}}).then(function(e){200==e.data.status&&(a.remenber={imei:a.search.imei,deviceTypeId:a.search.devaceType,platform:a.search.pdofnm,companyId:a.search.companyId,pageNo:1,pageSize:10},console.log(a.currentPage=1),a.currentPage=1,a.pageMax=e.data.data.totalCount,a.deviceList=e.data.data.list,a.onOff=!1)})},setAllselect:function(){this.search={imei:"",pdofnm:"",devaceType:"",status:"",companyId:""},this.getAllDevice(!1)},deleteDevice:function(e){var t=this;this.$confirm("此操作将删除该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.post("/device/deleteDevice",{id:e.id}).then(function(a){200==a.data.status?t.$notify({title:"成功",message:"设备"+e.imei+a.data.msg,type:"success"}):400==a.data.status?t.$message({type:"error",message:a.data.msg}):t.$message({type:"warning",message:a.data.msg}),t.getAllDevice()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getAllCompany:function(){var e=this;this.$axios.post("/company/getall").then(function(t){e.companytable=t.data.data})},shuaxin:function(){this.shua=!1,this.getAllDevice()},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.getAllDevice(!0,e)}},mounted:function(){this.getAllDevice(),this.getAllCompany(),this.getAlldeviceType(),console.log()},beforeMount:function(){this.onOff=!0},beforeCreate:function(){},beforeDestroy:function(){},beforeUpdate:function(){}}},S2h5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Oe0q"),l=a("Dcwy"),s=!1;var o=function(e){s||a("xhan")},r=a("X4nt")(i.a,l.a,!1,o,"data-v-69543bfa",null);r.options.__file="pages\\System\\device\\index.vue",t.default=r.exports},"eE+D":function(e,t,a){(e.exports=a("UTlt")(!1)).push([e.i,"#device[data-v-69543bfa]{width:100%;height:100%;position:relative}.device_nav[data-v-69543bfa]{height:44px;text-align:left;line-height:44px;font-size:14px;font-family:黑体;font-weight:700;border-bottom:1px solid #dfdfdf}.device_nav .title[data-v-69543bfa]{width:96%;margin:0 auto;height:44px}#device .el-table th.gutter[data-v-69543bfa]{display:none!important}.device_con[data-v-69543bfa]{width:96%;margin:20px auto;font-size:14px;height:500px;text-align:left;position:relative;padding-top:50px}#search[data-v-69543bfa]{text-align:left}",""])},xhan:function(e,t,a){var i=a("eE+D");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("FIqI")("abbce6b6",i,!1,{sourceMap:!1})}});